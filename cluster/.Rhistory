lmm.data.scaled[,"social"] <- scale(lmm.data.scaled[,"social"])
head(lmm.data.scaled)
# select the dataset
data <- lmm.data
# Non hierarchical models ------------------------------------------------------
# simple linear additive model, which is fit with ordinary least squares.
# This does not allow us to compare models using information criteria like AIC
OLSexamp <- lm(extro ~ open + agree + social, data = data)
display(OLSexamp)
# so we take the GLM approach which fits the model usin maximum Likelihood.
# This maximizes the plausibility of the data, given the assumed model and
# parameters
MLexamp <- glm(extro ~ open + agree + social, data=data)
display(MLexamp)
summary(OLSexamp)
# so we take the GLM approach which fits the model usin maximum Likelihood.
# This maximizes the plausibility of the data, given the assumed model and
# parameters
MLexamp <- glm(extro ~ open + agree + social, data=data)
display(MLexamp)
display(OLSexamp)
# so we take the GLM approach which fits the model usin maximum Likelihood.
# This maximizes the plausibility of the data, given the assumed model and
# parameters
MLexamp <- glm(extro ~ open + agree + social, data=data)
display(MLexamp)
# This means each site or each group or whatever clustering of dependent variables
# exist. They have differing baselines, due to an unspecified reason.
MLexamp.2 <- glm(extro ~ open + agree + social + class, data=data )
display(MLexamp.2)
AIC(MLexamp,MLexamp.2)
# schools are assumed to be different - this seems more plausible
MLexamp.3 <- glm(extro ~ open + agree + social + school, data=data )
display(MLexamp.3)
scale <- function(x) x / max(x)
lmm.data.scaled[,"open"]   <- scale(lmm.data.scaled[,"open"])
lmm.data.scaled[,"agree"]  <- scale(lmm.data.scaled[,"agree"])
lmm.data.scaled[,"social"] <- scale(lmm.data.scaled[,"social"])
head(lmm.data.scaled)
summary(lmm.data.scaled)
# select the dataset
data <- lmm.data
data <- lmm.data.scaled
# schools are assumed to be different - this seems more plausible
MLexamp.3 <- glm(extro ~ open + agree + social + school, data=data )
display(MLexamp.3)
# what if schools are the only driver?
MLexamp.4 <- glm(extro ~ school, data=data )
display(MLexamp.4)
AIC(MLexamp.4, MLexamp.3)
MLexamp.5 <- glm(extro ~ open + agree + social + school:class, data=data )
display(MLexamp.5)
# schools are assumed to be different - this seems more plausible
MLexamp.3 <- glm(extro ~ open + agree + social + school, data=data )
display(MLexamp.3)
# see that now we use lmer instead of glm.
# Grouping variables like class and school are specified using (1|school) syntax
MLexamp.8 <- lmer(extro ~ open + agree + social + (1|school/class), data=data, REML = TRUE)
display(MLexamp.8)
summary(MLexamp.3)
summary(MLexamp.8)
summary(MLexamp.8)
# see that now we use lmer instead of glm.
# Grouping variables like class and school are specified using (1|school) syntax
MLexamp.8 <- lmer(extro ~ open + agree + social + (1), data=data, REML = TRUE)
# see that now we use lmer instead of glm.
# Grouping variables like class and school are specified using (1|school) syntax
MLexamp.8 <- lmer(extro ~ open + agree + social + (1|1), data=data, REML = TRUE)
cbind(data,1)
# see that now we use lmer instead of glm.
# Grouping variables like class and school are specified using (1|school) syntax
MLexamp.8 <- lmer(extro ~ open + agree + social + (1|ri), data=cbind(data,ri=1), REML = TRUE)
# see that now we use lmer instead of glm.
# Grouping variables like class and school are specified using (1|school) syntax
MLexamp.8 <- lmer(extro ~ open + agree + social + (1|school/class), data=data, REML = TRUE)
summary(MLexamp.8)
# see that now we use lmer instead of glm.
# Grouping variables like class and school are specified using (1|school) syntax
MLexamp.8 <- lmer(extro ~ open + agree + social + (1|school)+ (1|class), data=data, REML = TRUE)
summary(MLexamp.8)
# see that now we use lmer instead of glm.
# Grouping variables like class and school are specified using (1|school) syntax
MLexamp.8 <- lmer(extro ~ open + agree + social + (1|school/class), data=data, REML = TRUE)
summary(MLexamp.8)
install.packages("plotrix")
x <- seq(1:100)
a <- 20
b <- 5
y <- rnorm(100,mean = a + b*x, sd = 10)
x <- seq(1,100, by = .1)
a <- 20
b <- 5
x <- seq(0,100, by = .1)
y <- rnorm(length(x),mean = a + b*x, sd = 10)
plot(x,y)
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b)
abline(a=a,b=b,lwd=1,col="red")
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="grey")
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
residuals(lm.1)
res <- residuals(lm.1)
plot(res)
hist(res)
sd(res)
plot(table(res))
plot(table(res),type="p")
density(res)
dens(res)
density(res)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
a <- 200
b <- 5
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
b <- 3
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
res <- residuals(lm.1)
plot(res)
abline(h=0, lwd=2, col="red")
plot(x,res)
abline(h=0, lwd=2, col="red")
abline(h=sd, lwd=2, lty=2)
abline(h=sd(res), lwd=2, lty=2)
abline(h=-sd(res), lwd=2, lty=2)
plot(x, sd(res)/x)
plot(x,res)
abline(h=0, lwd=2, col="red")
abline(h=sd(res), lwd=2, lty=2)
abline(h=-sd(res), lwd=2, lty=2)
lines(x, sd(res)/x)
plot(x,res)
abline(h=0, lwd=2, col="red")
abline(h=sd(res), lwd=2, lty=2)
abline(h=-sd(res), lwd=2, lty=2)
lines(x, sd(res)/x,col="green")
points(x,res/x,col="green")
lines(x, sd(res)/x,col="darkgreen", lwd=2)
lines(x, -sd(res)/x,col="darkgreen", lwd=2)
plot(x,res)
abline(h=0, lwd=2, col="red")
abline(h=sd(res), lwd=2, lty=2)
abline(h=-sd(res), lwd=2, lty=2)
lines(x, sd(res)/x,col="darkgreen", lwd=2)
lines(x, -sd(res)/x,col="darkgreen", lwd=2)
points(x,res/x,col="green")
x <- seq(0,100, by = .1)
a <- 200
b <- 3
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
res <- residuals(lm.1)
plot(x,res)
abline(h=0, lwd=2, col="red")
abline(h=sd(res), lwd=2, lty=2)
abline(h=-sd(res), lwd=2, lty=2)
lines(x, sd(res)/x,col="darkgreen", lwd=2)
lines(x, -sd(res)/x,col="darkgreen", lwd=2)
points(x,res/x,col="green")
x <- seq(200,300, by = .1)
a <- 200
b <- 3
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
res <- residuals(lm.1)
plot(x,res)
abline(h=0, lwd=2, col="red")
abline(h=sd(res), lwd=2, lty=2)
abline(h=-sd(res), lwd=2, lty=2)
lines(x, sd(res)/x,col="darkgreen", lwd=2)
lines(x, -sd(res)/x,col="darkgreen", lwd=2)
points(x,res/x,col="green")
x <- seq(0  , 100, by = .1)
a <- 200
b <- 3
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
res <- residuals(lm.1)
plot(x,res)
abline(h=0, lwd=2, col="red")
abline(h=sd(res), lwd=2, lty=2)
abline(h=-sd(res), lwd=2, lty=2)
lines(x, sd(res)/x,col="darkgreen", lwd=2)
lines(x, -sd(res)/x,col="darkgreen", lwd=2)
points(x,res/x,col="green")
hist(res)
sd(res)
plot(x,res)
abline(h=0, lwd=2, col="red")
abline(h=sd(res), lwd=2, lty=2)
abline(h=-sd(res), lwd=2, lty=2)
lines(x, sd(res)/x,col="darkgreen", lwd=2)
lines(x, -sd(res)/x,col="darkgreen", lwd=2)
points(x,res/x,col="green")
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
sd(y)
lines(x, sd(y)/x,col="darkgreen", lwd=2)
lines(x, y/x,col="darkgreen", lwd=2)
lines(x, res,col="darkgreen", lwd=2)
lines(x, y-a-x*b,col="darkgreen", lwd=2)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
y-a-x*b
y
lines(x, y,col="darkgreen", lwd=2)
y/x
lines(x, y/x,col="darkgreen", lwd=2)
lines(x, y/x + y,col="darkgreen", lwd=2)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
points(x, y/x + y,col="darkgreen", lwd=2)
points(x, (a+b*x)/x + y,col="darkgreen", lwd=2)
(a+b*x)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
points(x, (a+b*x)/x + (a+b*x),col="darkgreen", lwd=2)
lines(x, (a+b*x)/x + (a+b*x),col="darkgreen", lwd=2)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lines(x, (a+b*x)/x + (a+b*x),col="darkgreen", lwd=2)
lines(x, sd(a+b*x)/x + (a+b*x),col="darkgreen", lwd=2)
lines(x, sd(y)/x + (a+b*x),col="darkgreen", lwd=2)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lines(x, sd(y)/x + (a+b*x),col="darkgreen", lwd=2)
lines(x, -sd(y)/x + (a+b*x),col="darkgreen", lwd=2)
points(x, y/x + (a+b*x), col="green")
y/x
(a+b*x)
points(x, y/x, col="green")
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lines(x, sd(y)/x + (a+b*x),col="darkgreen", lwd=2)
lines(x, -sd(y)/x + (a+b*x),col="darkgreen", lwd=2)
points(x, y/x + (a+b*x), col="green")
plot(x,res)
abline(h=0, lwd=2, col="red")
abline(h=sd(res), lwd=2, lty=2)
abline(h=-sd(res), lwd=2, lty=2)
lines(x, sd(res)/x,col="darkgreen", lwd=2)
lines(x, -sd(res)/x,col="darkgreen", lwd=2)
points(x,res/x,col="green")
points(x, res/x + (a+b*x), col="green")
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lines(x, sd(y)/x + (a+b*x),col="darkgreen", lwd=2)
lines(x, -sd(y)/x + (a+b*x),col="darkgreen", lwd=2)
points(x, res/x + (a+b*x), col="green")
x <- seq(0  , 20, by = .1)
a <- 200
b <- 3
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
res <- residuals(lm.1)
plot(x,res)
abline(h=0, lwd=2, col="red")
abline(h=sd(res), lwd=2, lty=2)
abline(h=-sd(res), lwd=2, lty=2)
lines(x, sd(res)/x,col="darkgreen", lwd=2)
lines(x, -sd(res)/x,col="darkgreen", lwd=2)
points(x,res/x,col="green")
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lines(x, sd(y)/x + (a+b*x),col="darkgreen", lwd=2)
lines(x, -sd(y)/x + (a+b*x),col="darkgreen", lwd=2)
points(x, res/x + (a+b*x), col="green")
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lines(x, sd(res)/x + (a+b*x),col="darkgreen", lwd=2)
lines(x, -sd(res)/x + (a+b*x),col="darkgreen", lwd=2)
points(x, res/x + (a+b*x), col="green")
x <- seq(0  , 20, by = .01)
a <- 200
b <- 3
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
res <- residuals(lm.1)
plot(x,res)
abline(h=0, lwd=2, col="red")
abline(h=sd(res), lwd=2, lty=2)
abline(h=-sd(res), lwd=2, lty=2)
lines(x, sd(res)/x,col="darkgreen", lwd=2)
lines(x, -sd(res)/x,col="darkgreen", lwd=2)
points(x,res/x,col="green")
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lines( x,  sd(res) /x + (a+b*x), col="darkgreen", lwd=2)
lines( x, -sd(res) /x + (a+b*x), col="darkgreen", lwd=2)
points(x,      res /x + (a+b*x), col="green")
abline(h=  sd(res) + (a+b*x) , lwd=2, lty=2)
lines( x,  sd(res) + (a+b*x) , lwd=2, lty=2)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
sd(res) + (a+b*x)
lines( x,  sd(res) + (a+b*x) , lwd=2, lty=2)
lines( x,  -sd(res) + (a+b*x) , lwd=2, lty=2)
lines( x,  sd(res) /x + (a+b*x), col="darkgreen", lwd=2)
lines( x, -sd(res) /x + (a+b*x), col="darkgreen", lwd=2)
points(x,      res /x + (a+b*x), col="green")
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lines( x,   sd(res) + (a+b*x) , lwd=2, lty=2)
lines( x,  -sd(res) + (a+b*x) , lwd=2, lty=2)
lines( x,  sd(res) /x + (a+b*x), col="darkgreen", lwd=2)
lines( x, -sd(res) /x + (a+b*x), col="darkgreen", lwd=2)
points(x,      res /x + (a+b*x), col="darkgreen")
legend("bottomright",legend=c("data","residuals scaled to predictor size","standard deviation","regression line"),
pch=c(0,0,NA,NA),lty=c(NA,NA,2,1), col=c("black","darkgreen","darkgreen","red"))
legend("bottomright",legend=c("data","residuals scaled to predictor size","standard deviation","regression line"),
pch=c(1,1,NA,NA),lty=c(NA,NA,2,1), col=c("black","darkgreen","darkgreen","red"))
legend("bottomright",
legend=c("data","residuals scaled to predictor size","standard deviation",
"scaled standard deviation","regression line"),
pch=c(1,1,NA,NA,NA),lty=c(NA,NA,2,1,1),
col=c("black","darkgreen","black","darkgreen","red"),lwd=2)
x <- seq(200, 300, by = .1)
x <- seq(0  , 20, by = .01)
a <- 200
b <- 3
y <- rnorm(length(x),mean = a + b*x, sd = 30)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lm.1 <- lm(y ~ x)
abline(coef = coef(lm.1), lty=2, lwd=2, col="black")
res <- residuals(lm.1)
plot(x,res)
abline(h=0, lwd=2, col="red")
abline(h=sd(res), lwd=2, lty=2)
abline(h=-sd(res), lwd=2, lty=2)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
points(x,      res / (a+b*x) + (a+b*x), col="darkgreen")
res / (a+b*x)
plot(x,y)
abline(a=a,b=b,lwd=2,col="red")
lines( x,   sd(res) + (a+b*x) , lwd=2, lty=2)
lines( x,  -sd(res) + (a+b*x) , lwd=2, lty=2)
lines( x,  sd(res) /x + (a+b*x), col="darkgreen", lwd=2)
sd(res)
getwd(dirname(rstudioapi::getActiveDocumentContext()$path))
rstudioapi::getActiveDocumentContext()
rstudioapi::getActiveDocumentContext()$path
dirname(rstudioapi::getActiveDocumentContext()$path)
getwd(dirname(rstudioapi::getActiveDocumentContext()$path))
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
tbl <- read.csv("parameter_analysis_20200630/output.txt", skip = 1)
library(data.table)
tbl <- fread(
"parameter_analysis_20200630/output.txt",
sep = ",",
header = TRUE
)
colnames(tbl)[1] <- "p_e"
tbl_orig <- tbl
sum(is.na(tbl))
sum(is.na(p_e))
sum(is.na(tbl$p_e))
sum(is.na(tbl$rho))
sum(is.na(tbl$phi))
sum(is.na(tbl$te))
sum(is.na(tbl$st))
which(is.na(tbl$te))
tbl[which(is.na(tbl$te)),]
summary(tbl$te)
tbl[tbl$te > 10e5,]
tbl[tbl$te > 10e4,]
nrow(tbl[tbl$te > 10e4,])
nrow(tbl[tbl$te > 50e4,])
nrow(tbl[tbl$te > 40e4,])
nrow(tbl[tbl$te > 30e4,])
nrow(tbl[tbl$te > 20e4,])
nrow(tbl[tbl$te > 15e4,])
nrow(tbl[tbl$te > 16e4,])
nrow(tbl[tbl$te > 17e4,])
nrow(tbl[tbl$te > 18e4,])
tbl[tbl$te > 18e4,]
tbl[which(tbl$te > 18e4),]
which(tbl$te > 18e4)
which(tbl$te > 18e4) / 10000
tbl[which(is.na(tbl$te)),]
tbl[which(is.na(tbl$te)),]
